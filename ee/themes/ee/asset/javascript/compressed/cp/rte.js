/*!
 * This source file is part of the open source project
 * ExpressionEngine (https://expressionengine.com)
 *
 * @link      https://expressionengine.com/
 * @copyright Copyright (c) 2003-2018, EllisLab, Inc. (https://ellislab.com)
 * @license   https://expressionengine.com/license Licensed under Apache License, Version 2.0
 */
!function(e){function t(t,o){e.getJSON(t,function(t){return t.error?void e.ee_notice(t.error,{type:"error"}):(r.find(".contents").html(t.success),void r.dialog("option","title",o).dialog("open"))})}function o(){e("#rte-builder-closer").click(function(e){e.preventDefault(),r.dialog("close")}),e("#rte-tools-selected, #rte-tools-unused").sortable({connectWith:".rte-tools-connected",containment:".rte-toolset-builder",placeholder:"rte-tool-placeholder",revert:200,tolerance:"pointer",beforeStop:function(e,t){t.item.replaceWith(t.helper.children().removeClass("rte-tool-active"))},helper:function(t,o){e(".rte-tools-connected").not(e(this)).children().removeClass("rte-tool-active"),o.addClass("rte-tool-active");var r=e(".rte-tool-active");return r.length||(r=o.addClass("rte-tool-active")),e("<div/>").attr("id","rte-drag-helper").css("opacity",.7).width(e(o).outerWidth()).append(r.clone())},start:function(t,o){e(this).children(".rte-tool-active").hide().addClass("rte-tool-remove"),e(this).children(".ui-sortable-placeholder").removeClass("rte-tool-active")},stop:function(){e(".rte-tool-remove").remove(),e(".rte-placeholder-fix").remove(),e(".rte-tools-connected").append('<li class="rte-placeholder-fix"/>')}}),e(".rte-tools-connected").append('<li class="rte-placeholder-fix"/>'),r.find("form").submit(function(t){t.preventDefault();var o=[];e("#rte-tools-selected .rte-tool").each(function(){o.push(e(this).data("tool-id"))}),e("#rte-toolset-tools").val(o.join("|")),e.post(e(this).attr("action"),e(this).serialize(),function(t){return t.error?void e("#rte_toolset_editor_modal .notice").text(t.error):(e.ee_notice(t.success,{type:"success"}),r.dialog("close"),void(t.force_refresh&&(window.location=window.location)))},"json")})}var r=e('<div id="rte_toolset_editor_modal"><div class="contents"/></div>');r.dialog({width:600,resizable:!1,position:["center","center"],modal:!0,draggable:!0,autoOpen:!1,zIndex:99999,open:function(e,t){o()}}),e("body").on("change","#toolset_id",function(){var o=e(this).val();return"0"==o||o==EE.rte.my_toolset_id?(e("#edit_toolset").show(),void("0"==o&&t(EE.rte.url.edit_my_toolset.replace(/&amp;/g,"&")))):void e("#edit_toolset").hide()}),e("#toolset_id").change(),e("#edit_toolset").click(function(){t(EE.rte.url.edit_my_toolset.replace(/&amp;/g,"&"),EE.rte.lang.edit_my_toolset)}),e("body").on("click",".edit_toolset",function(o){o.preventDefault();var r="create_toolset"==this.id?EE.rte.lang.create_toolset:EE.rte.lang.edit_toolset;t(e(this).attr("href"),r)}),r.on("click",".rte-tool",function(){e(this).toggleClass("rte-tool-active")})}(jQuery);